<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kaipo Moʻe</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <!-- Styles -->
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>

  <!-- Top gradient backdrop -->
  <div class="top-gradient" aria-hidden="true"></div>

  <!-- Header -->
  <header id="site-header" class="header">
    <nav class="nav" aria-label="Primary">
      <a class="brand" href="#top">Kaipo Moʻe</a>

      <!-- Desktop links -->
      <div class="links" id="nav-links">
        <a href="#home">Home</a>
        <a href="#island">The Island</a>
        <a href="#music">Music</a>
        <a href="#art">Art</a>
        <a href="#contact">Contact</a>
      </div>

      <!-- Mobile toggle -->
      <button id="nav-toggle" class="nav-toggle" aria-expanded="false" aria-controls="mobile-menu" aria-label="Open menu">
        <span></span><span></span><span></span>
      </button>
    </nav>

    <!-- Mobile menu panel -->
    <div id="mobile-menu" class="mobile-menu" aria-hidden="true">
      <a href="#home">Home</a>
      <a href="#island">The Island</a>
      <a href="#music">Music</a>
      <a href="#art">Art</a>
      <a href="#contact">Contact</a>
    </div>
  </header>

  <!-- Masthead: white logo area under header -->
  <section id="top" class="masthead" aria-label="Logo">
    <img class="wordmark" src="assets/images/logo-top.png" alt="Kaipo Moʻe logo">
  </section>

  <main>
    <!-- Hero (contained window, not full-bleed) -->
    <section id="home" class="hero" aria-label="Hero">
      <div class="container">
        <div class="hero-window">
          <video
            class="hero-video"
            src="assets/video/hero.mp4"
            poster="assets/images/hero-poster.jpg"
            playsinline
            muted
            loop
            autoplay>
          </video>

          <div class="hero-copy">
            <h1>Enter the Island</h1>
            <p><a class="btn" href="https://youtu.be/-4iri-fnqWo?si=0-OM_OJYbk8fIitu" target="_blank" rel="noopener">Watch the Full Video</a></p>
          </div>
        </div>
      </div>
    </section>

    <!-- Divider -->
    <div class="section-line" aria-hidden="true"></div>

    <!-- Poem — KH-style sequence with ethereal wind -->
    <section id="island" class="section island" aria-label="The Island Poem">
      <div class="poem-stage">
        <h2 class="island-title">The Island</h2>

        <!-- Lines render stacked; JS crossfades them -->
        <p class="line">The island of your mind</p>
        <p class="line">A wish you long to find,</p>
        <p class="line">A place where you can hide,</p>
        <p class="line">The mirror of your eyes.</p>
        <p class="line">Beneath a stranger sky,</p>
        <p class="line">That feeling never dies,</p>
        <p class="line">In the island of your mind.</p>
      </div>
    </section>

    <!-- Divider -->
    <div class="section-line" aria-hidden="true"></div>

    <!-- Music -->
    <section id="music" class="section">
      <div class="container">
        <h2>Music</h2>
        <p class="lead">Listen to Kaipo Moʻe on your favorite platform.</p>

        <div class="card">
          <!-- Spotify only -->
          <iframe style="border-radius:12px" src="https://open.spotify.com/embed/artist/7CrqF9bBDu5UC8iCuLqtOF?utm_source=oembed"
            width="100%" height="352" frameborder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>

          <div class="btn-row">
            <a class="btn" href="https://open.spotify.com/artist/7CrqF9bBDu5UC8iCuLqtOF?si=GAGpqmfVR2WZlEBFsKrFKw" target="_blank" rel="noopener">Listen on Spotify</a>
            <a class="btn" href="https://music.apple.com/us/artist/kaipo-moe/1469973347" target="_blank" rel="noopener">Listen on Apple Music</a>
          </div>
        </div>
      </div>
    </section>

    <!-- Divider -->
    <div class="section-line" aria-hidden="true"></div>

    <!-- Art -->
    <section id="art" class="section">
      <div class="container">
        <h2>Art</h2>
        <div class="gallery">
          <figure><img src="assets/images/gallery/art-1.jpg" alt="Artwork 1"></figure>
          <figure><img src="assets/images/gallery/art-2.jpg" alt="Artwork 2"></figure>
          <figure><img src="assets/images/gallery/art-3.jpg" alt="Artwork 3"></figure>
          <figure><img src="assets/images/gallery/art-4.jpg" alt="Artwork 4"></figure>
          <figure><img src="assets/images/gallery/art-5.jpg" alt="Artwork 5"></figure>
          <figure><img src="assets/images/gallery/art-6.jpg" alt="Artwork 6"></figure>
        </div>
      </div>
    </section>

    <!-- Divider -->
    <div class="section-line" aria-hidden="true"></div>

    <!-- Contact -->
    <section id="contact" class="section contact">
      <div class="container">
        <h2 class="center">Contact</h2>
        <p class="center soft">For creative projects, collaborations, or just to connect:</p>
        <p class="center">
          <a class="btn" href="mailto:1kaipomoe@gmail.com">Email Me</a>
        </p>

        <p class="social center">
          <a href="https://www.instagram.com/kaipomoe?igsh=NjZvbDQwcG85Ynhw&utm_source=qr" target="_blank" rel="noopener" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
          <a href="https://www.youtube.com/@kaipomoe" target="_blank" rel="noopener" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
          <a href="https://open.spotify.com/artist/7CrqF9bBDu5UC8iCuLqtOF?si=GAGpqmfVR2WZlEBFsKrFKw" target="_blank" rel="noopener" aria-label="Spotify"><i class="fab fa-spotify"></i></a>
          <a href="https://music.apple.com/us/artist/kaipo-moe/1469973347" target="_blank" rel="noopener" aria-label="Apple Music"><i class="fab fa-apple"></i></a>
          <a href="https://www.tiktok.com/@kaipomoe" target="_blank" rel="noopener" aria-label="TikTok"><i class="fab fa-tiktok"></i></a>
        </p>

        <div class="logo-bottom">
          <img src="assets/images/logo-bottom.png" alt="Kaipo Moʻe logo">
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <p>© <span id="year"></span> Kaipo Moʻe. All rights reserved.</p>
  </footer>

  <!-- Scripts -->
  <script>
    // Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Header reveal + hybrid background
    const header = document.getElementById('site-header');
    const masthead = document.querySelector('.masthead');
    const hero = document.querySelector('.hero');
    const mobileMenu = document.getElementById('mobile-menu');
    const navToggle = document.getElementById('nav-toggle');

    const headerHeight = 64;
    document.documentElement.style.setProperty('--header-h', headerHeight + 'px');

    let revealed = false;
    function onScroll() {
      const y = window.scrollY || window.pageYOffset;

      // Reveal header on first meaningful scroll
      if (!revealed && y > 10) {
        header.classList.add('is-visible');
        revealed = true;
      }

      // Switch from translucent to solid after passing hero window
      const cutoff = masthead.offsetHeight + hero.offsetHeight - 10;
      if (y > cutoff) {
        header.classList.add('is-solid');
      } else {
        header.classList.remove('is-solid');
      }
    }
    window.addEventListener('scroll', onScroll, { passive: true });

    // Mobile menu
    function closeMenu() {
      mobileMenu.classList.remove('open');
      navToggle.setAttribute('aria-expanded', 'false');
      mobileMenu.setAttribute('aria-hidden', 'true');
      document.body.classList.remove('no-scroll');
    }
    navToggle.addEventListener('click', () => {
      const expanded = navToggle.getAttribute('aria-expanded') === 'true';
      if (expanded) { closeMenu(); }
      else {
        mobileMenu.classList.add('open');
        navToggle.setAttribute('aria-expanded', 'true');
        mobileMenu.setAttribute('aria-hidden', 'false');
        document.body.classList.add('no-scroll');
      }
    });
    mobileMenu.querySelectorAll('a').forEach(a => a.addEventListener('click', closeMenu));
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeMenu(); });

    // ====== Poem: KH-style crossfade with ethereal wind on every line ======
    (function(){
      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const stage = document.querySelector('.poem-stage');
      if (!stage) return;

      const lines = Array.from(stage.querySelectorAll('.line'));
      const title = stage.querySelector('.island-title');

      function makeWindSVG(variant) {
        // basic S-curve variants
        const paths = [
          'M -120 0 C -40 -30, 40 -30, 120 0',
          'M -120 0 C -60 20, 60 -20, 120 0',
          'M -120 0 C -40 30, 40 30, 120 0',
          'M -120 0 C -80 -15, 80 -15, 120 0'
        ];
        const d = paths[variant % paths.length];
        const svg = document.createElementNS('http://www.w3.org/2000/svg','svg');
        svg.setAttribute('class','wind');
        svg.setAttribute('viewBox','-130 -50 260 100');
        const p = document.createElementNS('http://www.w3.org/2000/svg','path');
        p.setAttribute('d', d);
        p.setAttribute('fill','none');
        p.setAttribute('stroke','rgba(158,194,255,0.07)'); // very subtle
        p.setAttribute('stroke-width','2');
        p.setAttribute('stroke-linecap','round');
        svg.appendChild(p);
        return svg;
      }

      // Layout: center everything, start hidden
      function reset() {
        stage.classList.remove('playing','fadeout');
        lines.forEach(l => { l.className = 'line'; l.style.opacity = 0; });
        title.style.opacity = 0;
        // remove lingering winds
        stage.querySelectorAll('.wind').forEach(w => w.remove());
      }

      function playSequence() {
        if (prefersReduced) {
          // Static fallback
          title.style.opacity = 1;
          lines.forEach(l => { l.style.opacity = 1; });
          return;
        }

        stage.classList.add('playing');
        // camera drift (will be handled in CSS via .playing)
        let t = 0;
        const fade = 900;     // ms
        const hold = 2200;    // ms
        const overlap = 400;  // ms

        // Helper to show an element with fade-in
        function showEl(el, delay) {
          setTimeout(() => { el.classList.add('visible'); }, delay);
        }
        // Helper to hide an element with fade-out
        function hideEl(el, delay) {
          setTimeout(() => { el.classList.remove('visible'); }, delay);
        }

        // 1) Title
        showEl(title, t);                     // fade in
        t += 2500;                            // hold
        hideEl(title, t - 600);               // start fading out before first line

        // 2) Lines with crossfades + wind
        lines.forEach((line, i) => {
          const appearAt = t + i * (hold - overlap);
          const disappearAt = appearAt + hold;

          // Wind: begin a touch before line appears
          setTimeout(() => {
            const svg = makeWindSVG(i);
            line.parentElement.insertBefore(svg, line);
            svg.classList.add('wind-start');
            // remove after animation (keep DOM light)
            setTimeout(() => svg.remove(), fade + hold);
          }, Math.max(0, appearAt - 200));

          showEl(line, appearAt);       // fade in
          hideEl(line, disappearAt);    // fade out (overlaps next)
        });

        // 3) Final line hold + dissolve background
        const finalIn = t + (lines.length - 1) * (hold - overlap);
        const finalOut = finalIn + hold + 1200; // linger a bit longer
        // Keep final line visible longer
        setTimeout(() => { lines.at(-1).classList.add('visible'); }, finalIn);
        setTimeout(() => { stage.classList.add('fadeout'); }, finalOut);

        // 4) Loop
        const total = finalOut + 1600;  // allow fade to complete before restart
        setTimeout(() => {
          reset();
          // slight pause before restarting for seamless loop
          setTimeout(playSequence, 300);
        }, total);
      }

      // Trigger when section enters viewport (once)
      const section = document.getElementById('island');
      const io = new IntersectionObserver(([entry]) => {
        if (entry.isIntersecting) {
          reset();
          playSequence();
          io.disconnect();
        }
      }, { threshold: 0.3 });
      io.observe(section);
    })();
  </script>
</body>
</html>
